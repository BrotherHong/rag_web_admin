# 🔐 權限系統快速測試指南

## 📝 測試步驟

### 1️⃣ 測試檢視者權限 (Viewer)

**登入資訊:**
- 帳號: `viewer`
- 密碼: `viewer123`

**預期行為:**

✅ **可以執行的操作:**
- 查看知識庫所有檔案
- 下載檔案
- 查看統計資訊
- 查看系統設定內容

❌ **無法執行的操作 (應顯示限制):**
- **上傳檔案頁面**: 顯示「權限不足」訊息,無法上傳
- **知識庫**: 刪除按鈕變灰色且禁用,顯示「僅主管以上可刪除檔案」
- **系統設定 - 分類管理**: 看不到「新增分類」按鈕,顯示「僅管理員可新增分類」
- **系統設定 - 使用者管理**: 看不到「新增使用者」按鈕,表格中操作欄顯示「無權限」
- **系統設定 - 各項設定**: 底部沒有「儲存設定」按鈕,顯示「僅管理員可修改設定」

---

### 2️⃣ 測試主管權限 (Manager)

**登入資訊:**
- 帳號: `hr_manager`
- 密碼: `manager123`

**預期行為:**

✅ **可以執行的操作:**
- 查看所有資料
- **上傳檔案**: 可以正常使用完整上傳流程
- **刪除檔案**: 可以點擊刪除按鈕並執行刪除

❌ **無法執行的操作 (應顯示限制):**
- **系統設定 - 分類管理**: 看不到「新增分類」按鈕,無法刪除分類
- **系統設定 - 使用者管理**: 看不到「新增使用者」按鈕,無法編輯/刪除使用者
- **系統設定 - 各項設定**: 底部沒有「儲存設定」按鈕

---

### 3️⃣ 測試管理員權限 (Admin)

**登入資訊:**
- 帳號: `admin`
- 密碼: `admin123`

**預期行為:**

✅ **可以執行所有操作:**
- 查看所有資料
- 上傳和刪除檔案
- 新增、編輯、刪除分類
- 新增、編輯、刪除使用者
- 修改系統設定
- 所有功能按鈕都可見且可點擊

---

## 🧪 詳細測試項目

### A. 檔案管理測試

| 操作 | Viewer | Manager | Admin |
|------|--------|---------|-------|
| 查看檔案列表 | ✅ | ✅ | ✅ |
| 下載檔案 | ✅ | ✅ | ✅ |
| 刪除檔案 | ❌ (按鈕禁用) | ✅ | ✅ |
| 上傳檔案 | ❌ (顯示權限不足) | ✅ | ✅ |

**測試步驟:**
1. 登入不同角色帳號
2. 進入「知識庫」頁面
3. 檢查刪除按鈕狀態
4. 進入「上傳檔案」頁面
5. 檢查是否可以選擇和上傳檔案

---

### B. 分類管理測試

| 操作 | Viewer | Manager | Admin |
|------|--------|---------|-------|
| 查看分類 | ✅ | ✅ | ✅ |
| 新增分類 | ❌ | ❌ | ✅ |
| 刪除分類 | ❌ | ❌ | ✅ |

**測試步驟:**
1. 登入不同角色帳號
2. 進入「系統設定」→「分類管理」
3. Viewer/Manager: 應看到提示「僅管理員可新增分類」
4. Admin: 應看到「新增分類」按鈕
5. 嘗試點擊分類旁的刪除按鈕

---

### C. 使用者管理測試

| 操作 | Viewer | Manager | Admin |
|------|--------|---------|-------|
| 查看使用者 | ✅ | ✅ | ✅ |
| 新增使用者 | ❌ | ❌ | ✅ |
| 編輯使用者 | ❌ | ❌ | ✅ |
| 刪除使用者 | ❌ | ❌ | ✅ |

**測試步驟:**
1. 登入不同角色帳號
2. 進入「系統設定」→「使用者管理」
3. Viewer/Manager: 應看到提示「僅管理員可新增使用者」,表格操作欄顯示「無權限」
4. Admin: 應看到「新增使用者」按鈕,可以編輯和刪除

---

### D. 系統設定測試

| 操作 | Viewer | Manager | Admin |
|------|--------|---------|-------|
| 查看設定 | ✅ | ✅ | ✅ |
| 修改設定 | ❌ | ❌ | ✅ |
| 儲存設定 | ❌ | ❌ | ✅ |

**測試步驟:**
1. 登入不同角色帳號
2. 進入「系統設定」→ 任一設定頁面 (AI 模型、知識庫等)
3. 嘗試修改設定值
4. 檢查底部按鈕:
   - Viewer/Manager: 應顯示「僅管理員可修改設定」
   - Admin: 應顯示「儲存設定」按鈕

---

## 🎯 API 權限測試

如果想測試 API 層級的權限檢查,可以打開瀏覽器開發者工具的 Console,執行以下操作:

### 測試檔案刪除權限

```javascript
// 以 viewer 身份登入後,嘗試刪除檔案
// 應該在 API 回應中看到權限錯誤訊息
```

### 測試分類管理權限

```javascript
// 以 manager 身份登入後,嘗試新增分類
// 應該在 API 回應中看到權限錯誤訊息
```

---

## ✅ 驗證清單

完成以下檢查項目,確保權限系統正常運作:

### Viewer 角色 (viewer / viewer123)
- [ ] 無法看到上傳檔案功能 (顯示權限不足提示)
- [ ] 無法刪除知識庫中的檔案 (刪除按鈕禁用)
- [ ] 無法在分類管理中新增或刪除分類
- [ ] 無法在使用者管理中進行任何操作 (顯示「無權限」)
- [ ] 無法儲存系統設定 (顯示「僅管理員可修改設定」)
- [ ] 可以查看所有資料和下載檔案

### Manager 角色 (hr_manager / manager123)
- [ ] 可以上傳檔案 (完整流程可用)
- [ ] 可以刪除檔案 (刪除按鈕可點擊)
- [ ] 無法新增或刪除分類
- [ ] 無法管理使用者
- [ ] 無法儲存系統設定
- [ ] 可以查看所有資料

### Admin 角色 (admin / admin123)
- [ ] 可以上傳和刪除檔案
- [ ] 可以新增和刪除分類
- [ ] 可以新增、編輯、刪除使用者
- [ ] 可以修改和儲存系統設定
- [ ] 所有功能按鈕都正常顯示

---

## 🐛 如果發現問題

如果發現權限控制不正常,請檢查:

1. **確認已登入正確角色**: 查看頂部導航欄的角色徽章
2. **清除瀏覽器快取**: 按 Ctrl+Shift+R (或 Cmd+Shift+R) 重新整理
3. **重新登入**: 登出後再次登入測試帳號
4. **檢查 Console**: 打開開發者工具查看是否有錯誤訊息

---

## 📊 預期結果總結

| 功能區域 | Viewer | Manager | Admin |
|---------|--------|---------|-------|
| 🏠 首頁統計 | 檢視 | 檢視 | 檢視 |
| 📚 知識庫 | 檢視+下載 | 檢視+下載+刪除 | 完全控制 |
| ⬆️ 上傳檔案 | ❌ 禁止 | ✅ 允許 | ✅ 允許 |
| 🏷️ 分類管理 | 檢視 | 檢視 | 完全控制 |
| 👥 使用者管理 | 檢視 | 檢視 | 完全控制 |
| ⚙️ 系統設定 | 檢視 | 檢視 | 完全控制 |

---

## 💡 測試技巧

1. **多開瀏覽器視窗**: 可以同時用不同帳號登入,快速對比權限差異
2. **使用無痕模式**: 避免快取影響測試結果
3. **按順序測試**: 從最低權限 (Viewer) 開始測試,逐步提升到最高權限 (Admin)
4. **記錄問題**: 如果發現權限異常,記錄操作步驟以便重現問題

---

## 🎉 測試完成

完成所有測試項目後,您應該能確認:
- ✅ 三種角色的權限完全符合設計規格
- ✅ UI 按鈕根據權限正確顯示/隱藏
- ✅ API 在收到非法請求時會拒絕並返回錯誤訊息
- ✅ 使用者能清楚看到自己的角色和權限限制

權限系統測試通過! 🎊
